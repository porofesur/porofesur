<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>خروج جنس از گدام</title>
    <style>body{font-family:tahoma;background:#111;color:#fff;}.container{max-width:400px;margin:60px auto;background:#222;padding:30px;border-radius:16px;box-shadow:0 4px 24px #0006;text-align:center}form{margin-bottom:25px}label{display:block;margin-bottom:6px}select,input{padding:9px;margin-bottom:14px;width:100%;border:1px solid #444;background:#111;color:#fff;border-radius:6px}button{background:#fff;color:#111;border:none;padding:12px 0;border-radius:8px;cursor:pointer;width:100%;font-size:18px;font-weight:bold;transition:all 0.2s;box-shadow:0 2px 8px #0002}button:hover{background:#111;color:#fff;border:1px solid #fff;box-shadow:0 4px 16px #0004}.msg{color:#27ae60;margin-bottom:10px}</style>
</head>
<body>
<div class="container">
    <h2>خروج جنس از گدام</h2>
    <div class="msg" id="msg"></div>
    <form id="outForm">
        <label>خروج جنس:</label>
        <select id="outItemSelect"></select>
        <label>تعداد خروج:</label>
        <input type="number" id="outQty" min="1" value="1">
        <button type="submit">ثبت خروج</button>
    </form>
    <a href="warehouse.html" style="display:block;margin:30px auto 0 auto;max-width:200px;background:#fff;color:#111;text-decoration:none;border-radius:8px;padding:12px 0;font-size:18px;font-weight:bold;transition:all 0.2s;box-shadow:0 2px 8px #0002;text-align:center">بازگشت به مدیریت گدام</a>
</div>
<script>
function getItems() {
    return JSON.parse(localStorage.getItem('warehouse_items') || '[]');
}
function saveItems(items) {
    localStorage.setItem('warehouse_items', JSON.stringify(items));
}
function renderOutSelect() {
    const items = getItems();
    const select = document.getElementById('outItemSelect');
    select.innerHTML = '';
    items.forEach((item, idx) => {
        if(item.qty > 0) {
            const opt = document.createElement('option');
            opt.value = idx;
            opt.textContent = item.name + ' (موجودی: ' + item.qty + ')';
            select.appendChild(opt);
        }
    });
    if(select.options.length === 0) {
        select.innerHTML = '<option>موجودی خالی است</option>';
    }
}
document.getElementById('outForm').onsubmit = function(e) {
    e.preventDefault();
    const select = document.getElementById('outItemSelect');
    const idx = parseInt(select.value);
    const outQty = parseInt(document.getElementById('outQty').value);
    let items = getItems();
    if(isNaN(idx) || outQty < 1 || !items[idx] || items[idx].qty < outQty) return;
    items[idx].qty -= outQty;
    saveItems(items);
    document.getElementById('msg').textContent = 'خروج جنس ثبت شد!';
    renderOutSelect();
    this.reset();
};
renderOutSelect();
</script>
</body>
    <footer style="margin-top:40px;text-align:center;color:#aaa;font-size:15px;">powered by porofesur</footer>
</html>